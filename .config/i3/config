# vim:filetype=i3
# i3 config file (v4)
#
# Please see http://i3wm.org/docs/userguide.html for a complete reference!


# == VARIABLES ==
# ===============

set $mod Mod4
set $term termite

set $default_gaps_inner 0
set $default_gaps_outer 0

# totally copied from Airblader
set_from_resource $darkred     color1  #000000
set_from_resource $red         color9  #000000
set_from_resource $darkgreen   color2  #000000
set_from_resource $green       color10 #000000
set_from_resource $darkyellow  color3  #000000
set_from_resource $yellow      color11 #000000
set_from_resource $darkblue    color4  #000000
set_from_resource $blue        color12 #000000
set_from_resource $darkmagenta color5  #000000
set_from_resource $magenta     color13 #000000
set_from_resource $darkcyan    color6  #000000
set_from_resource $cyan        color14 #000000
set_from_resource $darkwhite   color7  #000000
set_from_resource $white       color15 #000000
# Use custom colors for black
set $black       #262626
set $darkblack   #1d2021
set $transparent #00000000


# == SETTINGS ==
# ==============

floating_modifier $mod

font pango:Source Code Pro, FontAwesome 8
# for_window [class="^.*"] border none
# for_window [class="^.*"] border pixel 2

gaps inner $default_gaps_inner
gaps outer $default_gaps_outer

workspace_auto_back_and_forth yes
floating_minimum_size -1 x -1
floating_maximum_size -1 x -1

# == window-specific settings ==

for_window [window_role="pop-up"] floating enable
for_window [window_role="bubble"] floating enable
for_window [window_role="task_dialog"] floating enable

for_window [window_type="dialog"] floating enable
for_window [window_type="menu"] floating enable

for_window [class="Audacious"] border none
for_window [instance="__scratchpad"] floating enable
for_window [instance="__nmtui"] floating enable

assign [class="(?i)thunderbird"] workspace 9

# == COLORS ==
# ============

# class                 border  backgr. text    indicator
#client.focused          #262626 #262626 #ebdbb2 #262626
#client.focused_inactive #262626 #262626 #ebdbb2 #262626
#client.unfocused        #1d2021 #1d2021 #ebdbb2 #1d2021
#client.urgent           #fb4934 #fb4934 #1d2021 #fb4934

#                       BORDER      BACKGROUND  TEXT        INDICATOR
client.focused          $black      $black		$white		$black
client.focused_inactive $black      $black      $white      $black
client.unfocused        $black      $black      $darkwhite	$black
client.urgent           $darkred    $darkred    $black      $darkred
client.background $black


# == KEYBINDS ==
# ==============

# open apps
bindsym $mod+Return exec $term
bindsym $mod+Shift+Return exec $term --name __scratchpad
bindsym $mod+a exec audacious
bindsym $mod+e exec thunar
bindsym $mod+l exec --no-startup-id $HOME/scripts/lock.sh
bindsym $mod+m exec thunderbird, workspace 9
bindsym $mod+w exec firefox

# media mode: put YouTube into fullscreen and execute this
bindsym $mod+y fullscreen disable; floating enable; resize set 300 200; sticky enable; move window to position 1060 6

# dmenu
bindsym $mod+d exec --no-startup-id dmenu_run -i -b -nb \#2b303b -nf \#c0c5ce -sb \#c0c5ce -sf \#2b303b

# kill
bindsym $mod+q kill
bindsym $mod+Shift+q kill

# change focus
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

# move focused window
bindsym $mod+Shift+Left move left 25px
bindsym $mod+Shift+Down move down 25px
bindsym $mod+Shift+Up move up 25px
bindsym $mod+Shift+Right move right 25px

# split
bindsym $mod+h split h
bindsym $mod+v split v

# fullscreen for focused container
bindsym $mod+f fullscreen toggle

# change container layout
bindsym $mod+t layout tabbed
bindsym $mod+z layout toggle split

# toggle tiling / floating
bindsym $mod+Shift+space floating toggle

# change focus between tiling / floating windows
bindsym $mod+space focus mode_toggle

# toggle sticky mode
bindsym $mod+Shift+s sticky toggle

# scratchpad
bindsym $mod+Shift+minus move scratchpad
bindsym $mod+Shift+plus scratchpad show

# switch to workspace
bindsym $mod+1 workspace 1
bindsym $mod+2 workspace 2
bindsym $mod+3 workspace 3
bindsym $mod+4 workspace 4
bindsym $mod+5 workspace 5
bindsym $mod+6 workspace 6
bindsym $mod+7 workspace 7
bindsym $mod+8 workspace 8
bindsym $mod+9 workspace 9

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace 1
bindsym $mod+Shift+2 move container to workspace 2
bindsym $mod+Shift+3 move container to workspace 3
bindsym $mod+Shift+4 move container to workspace 4
bindsym $mod+Shift+5 move container to workspace 5
bindsym $mod+Shift+6 move container to workspace 6
bindsym $mod+Shift+7 move container to workspace 7
bindsym $mod+Shift+8 move container to workspace 8
bindsym $mod+Shift+9 move container to workspace 9

# switch workspaces
bindsym Mod1+Tab focus right
bindsym Mod1+Shift+Tab focus left
bindsym $mod+Tab workspace next
bindsym $mod+Shift+Tab workspace prev

# reload the configuration file
bindsym $mod+Shift+c reload
# restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
bindsym $mod+Shift+r restart

# capslock indicator
# you can use this if you decide to use i3bar+i3blocks
bindsym --release Caps_Lock exec pkill -SIGRTMIN+11 i3blocks

# volume
#bindsym XF86AudioLowerVolume exec --no-startup-id $HOME/scripts/volume_control.py down 5
#bindsym XF86AudioRaiseVolume exec --no-startup-id $HOME/scripts/volume_control.py up 5
#bindsym XF86AudioMute exec --no-startup-id $HOME/scripts/volume_control.py toggle 5
bindsym XF86AudioLowerVolume exec --no-startup-id "pactl set-sink-mute 1 false; pactl -- set-sink-volume 1 -5%"
bindsym XF86AudioRaiseVolume exec --no-startup-id "pactl set-sink-mute 1 false; pactl -- set-sink-volume 1 +5%"
bindsym XF86AudioMute exec --no-startup-id "pactl set-sink-mute 1 toggle"

# == MODES ==
# ###########

# RESIZE MODE
mode "resize" {
	bindsym Left resize shrink width 5 px or 2 ppt
	bindsym Down resize shrink height 5 px or 2 ppt
	bindsym Up resize grow height 5 px or 2 ppt
	bindsym Right resize grow width 5 px or 2 ppt

	bindsym Return mode "default", exec echo "" > $HOME/.i3mode
	bindsym Escape mode "default", exec echo "" > $HOME/.i3mode
}
bindsym $mod+r exec echo "resize" > $HOME/.i3mode, mode "resize"

# SETTINGS MODE
set $settings "settings: (a) audio (l) lxappearance (p) power management (w) wifi (x) xfce settings manager"
mode $settings {
	bindsym a exec pavucontrol, exec echo "" > $HOME/.i3mode, mode "default"
	bindsym l exec lxappearance, exec echo "" > $HOME/.i3mode, mode "default"
	bindsym p exec xfce4-power-manager-settings, exec echo "" > $HOME/.i3mode, mode "default"
	bindsym w exec urxvt -name __nmtui -e nmtui, exec echo "" > $HOME/.i3mode, mode "default"
	bindsym x exec xfce4-settings-manager, exec echo "" > $HOME/.i3mode, mode "default"

	bindsym Return mode "default", exec echo "" > $HOME/.i3mode
	bindsym Escape mode "default", exec echo "" > $HOME/.i3mode
}
bindsym $mod+x exec echo $settings > $HOME/.i3mode, mode $settings

# POWER MODE
set $power "power: (l) logout (s) shutdown (r) reboot"
mode $power {
	bindsym l exec echo "" > $HOME/.i3mode, exec i3-msg exit, mode "default"
	bindsym s exec echo "" > $HOME/.i3mode, exec systemctl poweroff, mode "default"
	bindsym r exec echo "" > $HOME/.i3mode, exec systemctl reboot, mode "default"

	bindsym Return exec echo "" > $HOME/.i3mode, mode "default"
	bindsym Escape exec echo "" > $HOME/.i3mode, mode "default"
}
bindsym $mod+p exec echo $power > $HOME/.i3mode, mode $power

# OUTER GAPS MODE
set $mode_gaps_outer "outer gaps: (+/-) resize (0) none (d) default"
mode $mode_gaps_outer {
	bindsym plus	gaps outer current plus 5
	bindsym minus	gaps outer current minus 5
	bindsym 0		gaps outer current set 0, exec echo "" > $HOME/.i3mode, mode "default"
	bindsym d		gaps outer current set $default_gaps_outer, exec echo "" > $HOME/.i3mode, mode "default"

	bindsym Return	exec echo "" > $HOME/.i3mode, mode "default"
	bindsym Escape	exec echo "" > $HOME/.i3mode, mode "default"
}
bindsym $mod+o mode $mode_gaps_outer, exec echo $mode_gaps_outer > $HOME/.i3mode

# INNER GAPS MODE
set $mode_gaps_inner "inner gaps: (+/-) resize (0) none (d) default"
mode $mode_gaps_inner {
	bindsym plus	gaps inner current plus 5
	bindsym minus	gaps inner current minus 5
	bindsym 0		gaps inner current set 0, exec echo "" > $HOME/.i3mode, mode "default"
	bindsym d		gaps inner current set $default_gaps_inner, exec echo "" > $HOME/.i3mode, mode "default"

	bindsym Return	exec echo "" > $HOME/.i3mode, mode "default"
	bindsym Escape	exec echo "" > $HOME/.i3mode, mode "default"
}
bindsym $mod+i mode $mode_gaps_inner, exec echo $mode_gaps_inner > $HOME/.i3mode



# == BAR ==
# =========

# Start i3bar to display a workspace bar (plus the system information i3status
# finds out, if available)
bar {
	# start i3bar in transparency mode, use RGBA colors!
	i3bar_command i3bar -t
	status_command i3blocks
	position bottom
	font pango:Source Code Pro, FontAwesome 10
	separator_symbol "â– "
	height 24

	colors {
		background	#26262600
		statusline	#ebdbb2ff
		separator	#00000000

		#colorclass			border		backgr		text
		focused_workspace	#00000000	#00000000	#ebdbb2ff
		active_workspace	#00000000	#00000000	#7c6f64ff
		inactive_workspace	#00000000	#00000000	#7c6f64ff
		urgent_workspace	#00000000	#00000000	#fb4934ff
		binding_mode		#00000000	#ebdbb2ff	#262626ff
	}
}

# == AUTOSTART ==
# ===============

# vsync to eliminate tearing, remove "--vsync opengl" if necessary
exec --no-startup-id compton --vsync opengl --shadow-exclude '!focused'

# enable nmapplet if you use a bar with systray support, like i3bar
#exec --no-startup-id nm-applet
exec --no-startup-id xfce4-power-manager
exec --no-startup-id xfsettingsd
exec --no-startup-id dunst
exec --no-startup-id mpd $HOME/.config/mpd/mpd.conf

# exec_always $HOME/scripts/lemonbar.sh

# this script sets a wallpaper based on battery level
# exec --no-startup-id $HOME/scripts/wallpaper.sh
exec_always --no-startup-id feh --bg-fill $HOME/.wallpapers/gruv.png
